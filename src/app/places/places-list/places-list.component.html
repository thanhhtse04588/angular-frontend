<!--Main layout-->
<main class="pt-5">
  <div class="container">
    <app-search-bar (onSearch)="searchHandlerAtParrent($event)"></app-search-bar>
    <!--Kết quả search-->
    <div *ngIf="searchCondition" class="card wow fadeIn mb-3">
      <div class="card-body text-black text-center py-3 px-3 my-3">
        <h4>
          Kết quả tìm kiếm: {{paging.countResult}} kết quả
        </h4>
        <button [disabled]='paging.countResult==0' type="button" (click)="showMap = !showMap"
          [innerHTML]="!showMap ? 'Xem trên bản đồ' : 'Xem trên danh sách'" mdbBtn color="primary"
          mdbWavesEffect></button>
      </div>
    </div>
    <!--/Kết quả search-->
    <!--Section: Cards-->
    <div *ngIf="!showMap;else map" class="text-center">

      <!--Grid row-->
      <div class="row wow fadeIn">

        <!--Grid column-->
        <div class="col-lg-4 col-md-6 mb-4" *ngFor="let place of places ">

          <!--Card-->
          <div class="card">
            <a (click)="placeDetail(place.placeID)">
              <!--Card image-->
              <div class="view overlay" style="height: 250px;">
                <div class="view "
                  style="background-image: url({{place.imageLarge}}); background-repeat: no-repeat; background-size: cover;">
                </div>
              </div>
              <!--Card content-->
              <div class="card-body">
                <!--Title-->
                <h4 class="card-title">{{shortTitle(place.title)}}...</h4>
                <!--Text-->
                <h5 class="card-title">{{place.roleOfPlaceName}}</h5>
                <p class="card-text">{{place.bedRooms|| '?'}} phòng ngủ - {{place.toilets|| '?'}} phòng vệ sinh -
                  {{place.area|| '?'}} m²
                </p>
                <h5 class="card-title"> {{place.district}}</h5>
                <h4 class="card-title">{{place.price| number}} vnđ</h4>
              </div>
            </a>
          </div>
          <!--/.Card-->
        </div>
        <!--Grid column-->
      </div>
      <!--Grid row-->

    </div>
    <!--Section: Cards-->
    <!-- map -->
    <ng-template #map>
      <agm-map style="height: 600px;" [latitude]="location.latitude" [longitude]="location.longitude"
        [zoom]="location.zoom">
        <agm-marker (markerClick)="clickedMarker(infowindow)" *ngFor="let place of location?.markers"
          [latitude]="place?.latitude" [longitude]="place?.longtitude">
          <agm-info-window #infowindow>
            <!--Card-->
            <div class="card" style="width: 300px;">
              <a (click)="placeDetail(place.placeID)">
                <!--Card image-->
                <div class="view overlay" style="height: 200px;">
                  <div class="view "
                    style="background-image: url({{place.imageLarge}}); background-repeat: no-repeat; background-size: cover;">
                  </div>
                </div>
                <!--Card content-->
                <div class="card-body">
                  <!--Title-->
                  <h5 class="card-title">{{shortTitle(place.title)}}...</h5>
                  <!--Text-->
                  <h6 class="card-title">{{place.roleOfPlaceName}}</h6>
                  <p class="card-text">{{place.bedRooms|| '?'}} phòng ngủ - {{place.toilets|| '?'}} phòng vệ sinh -
                    {{place.area|| '?'}} m²
                  </p>
                  <h6 class="card-title"> {{place.district}}</h6>
                  <h5 class="card-title">{{place.price| number}} vnđ</h5>
                </div>
              </a>
            </div>
            <!--/.Card-->
          </agm-info-window>
        </agm-marker>
      </agm-map>

    </ng-template>

    <!--Pagination-->
    <nav class="mt-3 d-flex justify-content-center wow fadeIn">
      <ul class="pagination pg-blue" *ngIf="paging && paging.countResult">

        <!--Arrow left-->
        <li class="page-item" [ngClass]="{disabled:paging.currentPage === 0}">
          <a class="page-link" (click)="gotoPage(paging.currentPage - 1)" aria-label="Previous">
            Previous
          </a>
        </li>

        <li *ngFor="let page of [].constructor(paging.pages); let i = index"
          [ngClass]="{active:paging.currentPage === i}" class="page-item">
          <a class="page-link" (click)="gotoPage(i)">{{i+1}}
          </a>
        </li>

        <li class="page-item" [ngClass]="{disabled:paging.currentPage === paging.pages-1}">
          <a class="page-link" (click)="gotoPage(paging.currentPage + 1)" aria-label="Next">
            Next
          </a>
        </li>
      </ul>
    </nav>
    <!--Pagination-->
  </div>
</main>
<!--Main layout-->
<script>
  $('li').click(function () {
    $(this).addClass('active').siblings().removeClass('active');
  });

</script>