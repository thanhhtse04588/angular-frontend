<body class="grey lighten-3">
  <div class="container wow fadeIn">
    <div class="row py-5">
      <!--Grid column-->
      <div class="col-md-3 ">
        <app-seller-menu></app-seller-menu>
      </div>
      <!--Grid column-->
      <div class="col-md-9">
        <div class="text-center">
          <div class="h3 text-center">ĐĂNG TIN RAO BÁN, CHO THUÊ NHÀ ĐẤT</div>
          <p>(Quý vị nhập thông tin nhà đất cần bán hoặc cho thuê vào các mục dưới đây)</p>
          <div *ngIf="!loginService.isUserLoggedIn()" class="alert alert-warning" role="alert">
            Bạn cần <a (click)='authGaurdService.showModal()'><strong style="cursor: pointer;">đăng nhập</strong> để
              thực hiện chức năng này</a>
          </div>
        </div>
        <div class="card">
          <form [formGroup]="form" (ngSubmit)="onSubmit(form.value)">
            <mat-vertical-stepper linear>
              <!-- page 1 -->
              <mat-step [completed]="isStepOneValid()">
                <ng-template matStepLabel>Thông tin cơ bản</ng-template>
                <!-- title -->
                <div class="mb-5">
                  <label for="title">
                    Tiêu đề<span class="red-text ">*</span>
                  </label>
                  <input type="text" id="title" formControlName="title" class="form-control">
                  <small class="red-text" *ngIf="sharedService.checkValidateInput(title)">
                    Yêu cầu từ 10-100 ký tự
                  </small>
                </div>
                <!--Grid row-->
                <div class="row">
                  <!-- district -->
                  <div class="col-lg-4 col-md-12 mb-4">
                    <label for="district">Quận/Huyện <span class="red-text">*</span></label>
                    <select class="custom-select d-block w-100 form-control" formControlName="district"
                      (change)="onDistrictChange()">
                      <option value='' disabled>Chọn...</option>
                      <option *ngFor="let item of districts" [ngValue]="item">{{item.district}}</option>
                    </select>
                    <small class="red-text" style="padding-top: 30px;"
                      *ngIf="sharedService.checkValidateInput(district)">
                      Không bỏ trống
                    </small>
                  </div>
                  <!-- ward -->
                  <div class="col-lg-4 col-md-12 mb-4">
                    <label for="ward">Phường/Xã<span class="red-text">*</span></label>
                    <select class="custom-select d-block w-100 form-control" formControlName="ward"
                      (change)="onWardChange()">
                      <option value='' disabled>Chọn...</option>
                      <option *ngFor="let item of wards" [ngValue]="item">{{item.wardName}}</option>
                    </select>
                    <small class="red-text" style="padding-top: 30px;" *ngIf="sharedService.checkValidateInput(ward)">
                      Không bỏ trống
                    </small>
                  </div>
                  <!-- street -->
                  <div class="col-lg-4 col-md-12 mb-4">
                    <label for="street">Đường/phố<span class="red-text">*</span></label>
                    <select class="custom-select d-block w-100 form-control" formControlName="street"
                      (change)="updateAddress()">
                      <option value='' disabled>Chọn...</option>
                      <option *ngFor="let item of streets" [ngValue]="item">{{item.streetName}}</option>
                    </select>
                    <small class="red-text" style="padding-top: 30px;" *ngIf="sharedService.checkValidateInput(street)">
                      Không bỏ trống
                    </small>
                  </div>
                </div>
                <div class="row">
                  <!-- roleOfPlaceID -->
                  <div class="col-lg-4 col-md-12 mb-4">
                    <label for="country">Loại nhà đất <span class="red-text">*</span></label>
                    <select class="custom-select d-block w-100 form-control" formControlName="roleOfPlaceID">
                      <option value='' disabled>Chọn...</option>
                      <option *ngFor="let item of roleOfPlaces" [ngValue]="item.roleOfPlaceID">{{item.roleName}}
                      </option>
                    </select>
                    <small class="red-text" style="padding-top: 30px;"
                      *ngIf="sharedService.checkValidateInput(roleOfPlaceID)">
                      Không bỏ trống
                    </small>
                  </div>
                  <!-- area -->
                  <div class="col-lg-4 col-md-12 mb-4">
                    <label for="area">Diện tích m²<span class="red-text">*</span></label>
                    <input type="number" id="area" formControlName="area" class="form-control">
                    <small class="red-text" *ngIf="sharedService.checkValidateInput(area)">
                      Không bỏ trống
                    </small>
                  </div>
                  <!-- price -->
                  <div class="col-lg-4 col-md-12   mb-4">
                    <label for="price">Giá (vnđ/tháng)<span class="red-text">*</span></label>
                    <input type="number" id="price" formControlName="price" class="form-control">
                    <div *ngIf="!sharedService.checkValidateInput(price)">{{price.value | currency:' ':'symbol':'2.0'}}
                    </div>
                    <small class="red-text" *ngIf="sharedService.checkValidateInput(price)">
                      Không bỏ trống
                    </small>
                  </div>
                </div>

                <div>
                  <button type="button" mat-stroked-button matStepperNext>Tiếp tục</button>
                </div>
              </mat-step>
              <!-- page2 -->
              <mat-step [completed]="isStepTwoValid()">
                <ng-template matStepLabel>Thông tin mô tả</ng-template>
                <div>Tối đa 3000 ký tự.<span class="red-text">*</span></div>
                <p>
                  Giới thiệu chung về bất động sản của bạn. Ví dụ: Khu nhà có vị trí thuận lợi: Gần công viên, gần
                  trường học ... Tổng diện tích 52m2, đường đi ô tô vào tận cửa.
                  <span class="red-text">Lưu ý: tin rao chỉ để mệnh giá tiền Việt Nam Đồng.</span></p>
                <!-- descriptions -->
                <div class=" ">
                  <textarea type="text" id="descriptions" formControlName="descriptions"
                    class="md-textarea form-control"></textarea>
                  <small class="red-text" *ngIf="sharedService.checkValidateInput(descriptions)">
                    Vui lòng nhập thông tin mô tả. Tối thiểu là 30 ký tự và tối đa là 3000 ký tự.
                  </small>
                  <label for="descriptions">Mô tả chi tiết</label>
                </div>

                <div>
                  <button mat-stroked-button matStepperPrevious>Quay lại</button>
                  <button type="button" mat-stroked-button matStepperNext>Tiếp tục</button>
                </div>
              </mat-step>
              <!-- page 3 -->
              <mat-step [completed]="isStepThreeValid()">
                <ng-template matStepLabel>Thông tin chi tiết</ng-template>
                <p>Quý vị nên điền đầy đủ thông tin vào các mục dưới đây để đăng tin có hiệu quả hơn.</p>
                <div class="row">
                  <!-- homeDirection -->
                  <div class="col-lg-4 col-md-12 mb-4">
                    <label for="homeDirection">Hướng nhà</label>
                    <select class="custom-select d-block w-100 form-control" formControlName="homeDirection">
                      <option value='' disabled>Chọn...</option>
                      <option *ngFor="let item of homeDirections" [ngValue]="item">{{item}}</option>
                    </select>
                  </div>

                  <!-- frontispiece -->
                  <div class="col-lg-4 col-md-12   mb-4">
                    <label for="frontispiece">Mặt tiền m²</label>
                    <input type="number" id="frontispiece" formControlName="frontispiece" class="form-control">
                    <small class="red-text" *ngIf="sharedService.checkValidateInput(frontispiece)">
                      Không hợp lệ
                    </small>
                  </div>
                </div>

                <div class="row">
                  <!-- numberFloors -->
                  <div class="col-lg-4 col-md-12   mb-4">
                    <label for="numberFloors">Số tầng</label>
                    <input type="number" id="numberFloors" formControlName="numberFloors" class="form-control">
                    <small class="red-text" *ngIf="sharedService.checkValidateInput(numberFloors)">
                      Không hợp lệ
                    </small>
                  </div>
                  <!-- numberBedrooms -->
                  <div class="col-lg-4 col-md-12   mb-4">
                    <label for="numberBedrooms">Số phòng ngủ</label>
                    <input type="number" id="numberBedrooms" formControlName="numberBedrooms" class="form-control">
                    <small class="red-text" *ngIf="sharedService.checkValidateInput(numberBedrooms)">
                      Không hợp lệ
                    </small>
                  </div>
                  <!-- numberToilets -->
                  <div class="col-lg-4 col-md-12   mb-4">
                    <label for="numberToilets">Số phòng vệ sinh</label>
                    <input type="number" id="numberToilets" formControlName="numberToilets" class="form-control">
                    <small class="red-text" *ngIf="sharedService.checkValidateInput(numberToilets)">
                      Không hợp lệ
                    </small>
                  </div>
                </div>

                <div>
                  <button mat-stroked-button matStepperPrevious>Quay lại</button>
                  <button type="button" mat-stroked-button matStepperNext>Tiếp tục</button>
                </div>
              </mat-step>
              <!-- page 4 -->
              <mat-step [completed]="isStepFourValid()">
                <ng-template matStepLabel>Thông tin nội thất</ng-template>
                <!-- Equipment -->
                <app-equipment></app-equipment>
                <div>
                  <button mat-stroked-button matStepperPrevious>Quay lại</button>
                  <button type="button" mat-stroked-button matStepperNext>Tiếp tục</button>
                </div>
              </mat-step>
              <!-- page 5 -->
              <!-- Cost of living -->
              <mat-step [completed]="isStepFiveValid()">
                <ng-template matStepLabel>Phí dịch vụ</ng-template>
                <app-cost-living></app-cost-living>
                <div>
                  <button mat-stroked-button matStepperPrevious>Quay lại</button>
                  <button type="button" mat-stroked-button matStepperNext>Tiếp tục</button>
                </div>
              </mat-step>
              <!-- page 6 -->
              <mat-step [completed]="isStepSixValid()">
                <ng-template matStepLabel>Ảnh mô tả</ng-template>
                <app-upload (upload)='uploadHandler($event)'></app-upload>
                <div>
                  <button mat-stroked-button matStepperPrevious>Quay lại</button>
                  <button type="button" mat-stroked-button matStepperNext>Tiếp tục</button>
                </div>
              </mat-step>
              <!-- page 7 -->
              <mat-step [completed]="isStepSevenValid()">
                <ng-template matStepLabel>Bản đồ</ng-template>
                <p>Để tăng độ tin cậy và tin rao được nhiều người quan tâm hơn, hãy sửa vị trí tin rao của bạn trên bản
                  đồ
                  bằng
                  cách
                  Chọn lại vị trí bản đồ</p>
                <div>
                  <label>Kiểm tra lại địa chỉ</label>
                  <input type="text" id="map" class="form-control" (keydown.enter)="$event.preventDefault()"
                    autocorrect="off" autocapitalize="off" spellcheck="off" #search>
                  <small class="red-text" class="red-text" *ngIf="!searchElementRef?.nativeElement?.value">
                    Không bỏ trống
                  </small>
                </div>
                <div class="mt-3">
                  <agm-map style="height: 600px;" [latitude]="latitude" [longitude]="longitude" [zoom]="zoom">
                    <agm-marker [latitude]="latitude" [longitude]="longitude" [markerDraggable]="true"
                      (dragEnd)="markerDragEnd($event)">
                    </agm-marker>
                  </agm-map>
                </div>

                <p>Có thể dữ liệu bản đồ không chính xác. Vì vậy nếu có bất kỳ sai xót nào xin bạn hãy báo cho chúng tôi
                  để
                  khắc
                  phục kịp thời.</p>

                <div>
                  <button mat-stroked-button matStepperPrevious>Quay lại</button>
                  <button type="button" mat-stroked-button matStepperNext>Tiếp tục</button>
                </div>
              </mat-step>
              <!-- page 8 -->
              <mat-step [completed]="isStepEightValid()">
                <ng-template matStepLabel>Liên hệ xem nhà</ng-template>
                <div class="row">
                  <!-- contactName -->
                  <div class="col-lg-4 col-md-12   mb-4">
                    <label for="contactName">Tên liên hệ<span class="red-text">*</span></label>
                    <input type="text" id="contactName" formControlName="contactName" class="form-control">
                    <small class="red-text" *ngIf="sharedService.checkValidateInput(contactName)">
                      Không bỏ trống
                    </small>
                  </div>

                  <!-- contactAddress -->
                  <div class="col-lg-4 col-md-12   mb-4">
                    <label for="contactAddress">Địa chỉ liên hệ</label>
                    <input type="text" id="contactAddress" formControlName="contactAddress" class="form-control">
                  </div>

                  <!-- phoneNumber -->
                  <div class="col-lg-4 col-md-12   mb-4">
                    <label for="phoneNumber">Số điện thoại liên hệ<span class="red-text">*</span></label>
                    <input type="text" id="phoneNumber" formControlName="phoneNumber" class="form-control">
                    <small class="red-text" *ngIf="sharedService.checkValidateInput(phoneNumber)">
                      Không hợp lệ
                    </small>
                  </div>
                </div>
                <div class="row">
                  <!-- email -->
                  <div class="col-lg-4 col-md-12   mb-4">
                    <label for="email">Email</label>
                    <input type="email" id="email" formControlName="email" class="form-control">
                    <small class="red-text" *ngIf="sharedService.checkValidateInput(email)">
                      Email không hợp lệ
                    </small>
                  </div>

                  <!-- checkingDate -->
                  <div class="col-lg-4 col-md-12  mb-4">
                    <label for="checkingDate">Ngày xem nhà <span class="red-text">*</span></label>
                    <input type="date" id="checkingDate" formControlName="checkingDate" class="form-control">
                    <div><small class="red-text">(Lớn hơn ngày hiện tại)</small></div>
                    <small class="red-text" class="red-text" *ngIf="sharedService.checkValidateInput(checkingDate)">
                      Không hợp lệ
                    </small>
                  </div>
                </div>
                <div>
                  <button mat-stroked-button matStepperPrevious>Quay lại</button>
                  <button type="button" mat-stroked-button matStepperNext>Tiếp tục</button>
                </div>
              </mat-step>
              <!-- done -->
              <mat-step>
                <ng-template matStepLabel>Hoàn thành</ng-template>
                <div>
                  <button mat-stroked-button matStepperPrevious>Quay lại</button>
                </div>
                <div *ngIf="!form.valid || !loginService.isUserLoggedIn()" class="alert alert-warning" role="alert">
                  Vui lòng điền thông tin đầy đủ theo yêu cầu
                </div>
                <button style="margin-right: 8px;" type="submit" mat-raised-button
                  [color]="placeEditID? 'warn':'primary'" size="md" [disabled]="!form.valid 
      || !loginService.isUserLoggedIn() 
      || isSubmit 
      || equipComponent?.eqmTable?.invalid 
      || costComponent?.eqmTable?.invalid 
      || !searchElementRef?.nativeElement?.value
      || imageUploaded.length == 0">
                  <span [ngClass]="{'spinner-border spinner-border-sm' : isSubmit}"> </span>
                  <span [innerHTML]="placeEditID? 'Lưu chỉnh sửa':' Yêu cầu đăng tin'"></span>
                </button>
                <button type="button" mat-raised-button color="accent" size="md"
                  [routerLink]="['/places/home']">Hủy</button>
              </mat-step>
            </mat-vertical-stepper>
          </form>
        </div>
      </div>
    </div>
  </div>
</body>